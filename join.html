<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
<meta name="robots" content="noindex">
    <meta name="googlebot" content="noindex">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.png">
    <title>djug雑談部 ルール</title>
    <!-- Google Fonts - Inter を追加し、よりモダンなフォントを使用 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS を追加して、モダンなデザインとレスポンシブ対応を強化 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* CSSカスタムプロパティでテーマカラーを定義 */
        :root {
            /* ライトモードのデフォルトカラー */
            --bg-color: #f2f3f5; /* Discordライトモードの背景色 */
            --container-bg: #ffffff;
            --text-color: #2e3338; /* Discordライトモードのテキスト色 */
            --header-color: #5865f2; /* Discordブルー */
            --border-color: #e3e5e8;
            --rules-bg: #f9f9f9;
            --button-bg: #5865f2;
            --button-hover-bg: #4752c4;
            --button-disabled-bg: #99aab5; /* Discordグレー */
            --input-bg: #ffffff;
            --input-border: #dcdcdc;
            --link-color: #007bff; /* リンク色 */
        }

        /* ダークモードのカラー設定 */
        .dark-mode {
            --bg-color: #36393f; /* Discordダークモードの背景色 */
            --container-bg: #2f3136; /* Discordダークモードのカード背景色 */
            --text-color: #dcddde; /* Discordダークモードのテキスト色 */
            --header-color: #5865f2; /* Discordブルー */
            --border-color: #202225;
            --rules-bg: #292b2f;
            --button-bg: #5865f2;
            --button-hover-bg: #4752c4;
            --button-disabled-bg: #4f545c;
            --input-bg: #202225;
            --input-border: #36393f;
            --link-color: #7289da; /* リンク色 */
        }

        /* カスタムプロパティを適用 */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease; /* スムーズな切り替え */
        }

        .container {
            background-color: var(--container-bg);
            transition: background-color 0.3s ease;
        }

        h1 {
            color: var(--header-color);
            transition: color 0.3s ease;
        }

        .rules {
            border-color: var(--border-color);
            background-color: var(--rules-bg);
            transition: border-color 0.3s ease, background-color 0.3s ease;
        }

        .rules p strong {
            color: var(--text-color); /* 強調テキストの色もテーマに合わせる */
        }

        .rules p {
            color: var(--text-color);
        }

        .agreement label {
            color: var(--text-color);
        }

        #agreeButton {
            background-color: var(--button-bg);
            transition: background-color 0.3s ease;
        }

        #agreeButton:hover:not(:disabled) {
            background-color: var(--button-hover-bg);
        }

        #agreeButton:disabled {
            background-color: var(--button-disabled-bg);
            cursor: not-allowed;
        }

        .security-question input {
            background-color: var(--input-bg);
            border-color: var(--input-border);
            color: var(--text-color);
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        .security-question button {
            background-color: var(--button-bg);
            transition: background-color 0.3s ease;
        }

        .security-question button:hover {
            background-color: var(--button-hover-bg);
        }

        /* スクロールバーのスタイルをカスタマイズ */
        .rules::-webkit-scrollbar {
            width: 8px;
        }
        .rules::-webkit-scrollbar-track {
            background: var(--rules-bg);
            border-radius: 10px;
        }
        .rules::-webkit-scrollbar-thumb {
            background: #888; /* スクロールバーのサムの色は固定 */
            border-radius: 10px;
        }
        .rules::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* ダーク/ライトモード切り替えボタンのスタイル */
        #themeToggle {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: var(--container-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 9999px; /* 丸い形 */
            padding: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        #themeToggle:hover {
            background-color: var(--rules-bg);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 relative">
    <!-- ダーク/ライトモード切り替えボタン -->
    <button id="themeToggle" aria-label="テーマを切り替える">
        <!-- SVGアイコンで太陽と月を表現 -->
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <!-- 太陽アイコン (ライトモード時) -->
            <path class="sun-icon" d="M12 2.5a.5.5 0 01.5.5v2a.5.5 0 01-1 0v-2a.5.5 0 01.5-.5zM12 19.5a.5.5 0 01.5.5v2a.5.5 0 01-1 0v-2a.5.5 0 01.5-.5zM19.5 12a.5.5 0 01.5.5h2a.5.5 0 010 1h-2a.5.5 0 01-.5-.5zM2.5 12a.5.5 0 01.5.5h2a.5.5 0 010 1h-2a.5.5 0 01-.5-.5zM17.379 6.621a.5.5 0 01.354.854l-1.414 1.414a.5.5 0 01-.707-.707l1.414-1.414a.5.5 0 01.353-.147zM6.621 17.379a.5.5 0 01.354.854l-1.414 1.414a.5.5 0 01-.707-.707l1.414-1.414a.5.5 0 01.353-.147zM17.379 17.379a.5.5 0 01-.354.854l-1.414 1.414a.5.5 0 01-.707-.707l1.414-1.414a.5.5 0 01.353-.147zM6.621 6.621a.5.5 0 01-.354.854l-1.414 1.414a.5.5 0 01-.707-.707l1.414-1.414a.5.5 0 01.353-.147zM12 7a5 5 0 100 10 5 5 0 000-10z" />
            <!-- 月アイコン (ダークモード時) -->
            <path class="moon-icon hidden" d="M12 3a9 9 0 109 9c0-.5-.04-1-.12-1.5A6.992 6.992 0 0112 3z" />
        </svg>
    </button>

    <div class="container rounded-xl shadow-lg p-8 max-w-2xl w-full">
        <!-- ヘッダー部分 -->
        <h1 class="text-4xl font-bold text-center mb-6">
            djug雑談部 ルール
        </h1>

        <!-- ルールと同意セクション -->
        <div id="rulesAndAgreementSection">
            <!-- ルール表示エリア -->
            <div class="rules border rounded-lg p-6 mb-6 h-96 overflow-y-auto leading-relaxed">
                <p class="mb-4"><strong>誹謗中傷をしないこと</strong></p>
                <p class="mb-4">当サーバーに入部中のメンバーやリアルの人等の誹謗中傷をしないでください。それで人びとたちは苦しんでしまいます。</p>
                <p class="mb-4"><strong>荒らしをしないこと</strong></p>
                <p class="mb-4">当サーバーは、荒らしで楽しむサーバーではありません！荒らしをされると、削除が大変になりますので絶対にしないでください。</p>
                <p class="mb-4"><strong>危険なファイルやリンクをアップしないこと</strong></p>
                <p class="mb-4">トロイの木馬等の入ったファイルや詐欺サイト、位置情報を盗むサイト、アダルトコンテンツが掲載されたサイト等を投稿することはやめてください。</p>
                <p class="mb-4"><strong>★ライブチャンネルに関して★</strong></p>
                <p class="mb-4">管理人の許可なく、ご自由に配信をしていただけます。</p>
                <p class="mb-4"><strong>★外部リンクについて★</strong></p>
                <p class="mb-4">シェアや参照が出来るように外部リンクを貼り付けることを許可していますが、アクセスされる場合は十分に注意してからアクセスをするようお願いします。</p>
                <p class="mb-4">※いかにも成人向けコンテンツの場合は、詐欺サイトの可能性がありますので、そのようなリンクを見つけたら、管理人のDMにてお知らせください。迅速に対応します。</p>
                <p class="mb-4"><strong>★著作権について★</strong></p>
                <p class="mb-4">動画、画像、文章は著作権で保護されてることが多く、人又は団体の著作物を許可なくアップロードすることは、「著作権法」で定められています。絶対に他人の著作物を許可なく載せないでください。</p>
            </div>

            <!-- 同意チェックボックスとボタン -->
            <div class="agreement flex items-center mb-6">
                <!-- Tailwind CSSでチェックボックスをスタイリング -->
                <input type="checkbox" id="agreeCheckbox" class="form-checkbox h-5 w-5 text-indigo-600 rounded focus:ring-indigo-500 mr-2 cursor-pointer">
                <label for="agreeCheckbox" class="text-lg select-none cursor-pointer">上記ルールに同意します</label>
            </div>

            <!-- 同意ボタン -->
            <button id="agreeButton" disabled class="w-full text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75 transition duration-300 ease-in-out disabled:cursor-not-allowed">
                同意する
            </button>
        </div>

        <!-- セキュリティ質問エリア (初期状態では非表示) -->
        <div id="securityQuestionArea" class="security-question mb-6 p-4 border rounded-lg hidden">
            <!-- 質問1 -->
            <div id="question1" class="">
                <p class="mb-3 text-lg font-semibold">セキュリティ質問 1/3:</p>
                <p class="mb-3">このサーバーの管理人は誰ですか？</p>
                <input type="text" id="adminNameInput" placeholder="ここに回答を入力してください" class="w-full p-2 border rounded-md mb-3 focus:outline-none focus:ring-2 focus:ring-indigo-500">
            </div>

            <!-- 質問2 (初期状態では非表示) -->
            <div id="question2" class="hidden">
                <p class="mb-3 text-lg font-semibold">セキュリティ質問 2/3:</p>
                <p class="mb-3">サーバー名は何ですか？</p>
                <input type="text" id="serverNameInput" placeholder="ここに回答を入力してください" class="w-full p-2 border rounded-md mb-3 focus:outline-none focus:ring-2 focus:ring-indigo-500">
            </div>

            <!-- 質問3 (初期状態では非表示) -->
            <div id="question3" class="hidden">
                <p class="mb-3 text-lg font-semibold">セキュリティ質問 3/3:</p>
                <p class="mb-3">利用しているサービス名は何ですか？</p>
                <input type="text" id="serviceNameInput" placeholder="ここに回答を入力してください" class="w-full p-2 border rounded-md mb-3 focus:outline-none focus:ring-2 focus:ring-indigo-500">
            </div>

            <button id="submitAnswerButton" class="w-full text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75 transition duration-300 ease-in-out">
                回答を送信
            </button>
            <p id="securityMessage" class="mt-3 text-sm text-red-500 text-center hidden"></p>
        </div>
    </div>

    <script>
        // DOMContentLoadedイベントでスクリプトを実行し、DOMが完全にロードされるのを待つ
        document.addEventListener('DOMContentLoaded', function() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            const sunIcon = themeToggle.querySelector('.sun-icon');
            const moonIcon = themeToggle.querySelector('.moon-icon');

            const rulesAndAgreementSection = document.getElementById('rulesAndAgreementSection'); // ルールと同意セクション全体
            const agreeCheckbox = document.getElementById('agreeCheckbox');         // 同意チェックボックスの要素を取得
            const agreeButton = document.getElementById('agreeButton');             // 同意ボタンの要素を取得

            const securityQuestionArea = document.getElementById('securityQuestionArea'); // セキュリティ質問エリア
            const question1Div = document.getElementById('question1');              // 質問1のdiv
            const question2Div = document.getElementById('question2');              // 質問2のdiv
            const question3Div = document.getElementById('question3');              // 質問3のdiv
            const adminNameInput = document.getElementById('adminNameInput');       // 管理者名入力フィールド (質問1)
            const serverNameInput = document.getElementById('serverNameInput');     // サーバー名入力フィールド (質問2)
            const serviceNameInput = document.getElementById('serviceNameInput');   // サービス名入力フィールド (質問3)
            const submitAnswerButton = document.getElementById('submitAnswerButton'); // 回答送信ボタン
            const securityMessage = document.getElementById('securityMessage');     // セキュリティメッセージ表示エリア

            let currentSecurityStep = 1; // 現在のセキュリティ質問のステップ (1: 質問1, 2: 質問2, 3: 質問3)

            // --- テーマ切り替え機能 ---
            /**
             * 現在のテーマ設定を適用する関数
             * @param {string} theme - 'light' または 'dark'
             */
            function applyTheme(theme) {
                if (theme === 'dark') {
                    body.classList.add('dark-mode');
                    sunIcon.classList.add('hidden');
                    moonIcon.classList.remove('hidden');
                } else {
                    body.classList.remove('dark-mode');
                    sunIcon.classList.remove('hidden');
                    moonIcon.classList.add('hidden');
                }
                localStorage.setItem('theme', theme); // テーマ設定をローカルストレージに保存
            }

            /**
             * 初期テーマ設定のロード
             * ローカルストレージに保存されたテーマがあればそれを適用し、なければシステム設定を適用します。
             */
            function loadTheme() {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme) {
                    applyTheme(savedTheme);
                } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    applyTheme('dark'); // システムがダークモードを好む場合
                } else {
                    applyTheme('light'); // デフォルトはライトモード
                }
            }

            // テーマ切り替えボタンのイベントリスナー
            themeToggle.addEventListener('click', function() {
                if (body.classList.contains('dark-mode')) {
                    applyTheme('light');
                } else {
                    applyTheme('dark');
                }
            });

            // システムのテーマ設定変更をリッスン
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                // ユーザーが手動でテーマを設定していない場合のみシステム設定を適用
                if (!localStorage.getItem('theme')) {
                    applyTheme(event.matches ? 'dark' : 'light');
                }
            });

            // ページロード時にテーマをロード
            loadTheme();

            // --- ルール同意とセキュリティ質問のフロー ---

            // 同意チェックボックスの状態が変更されたときのイベントリスナー
            agreeCheckbox.addEventListener('change', function() {
                // チェックボックスがチェックされていれば「同意する」ボタンを有効化、そうでなければ無効化
                agreeButton.disabled = !this.checked;
            });

            /**
             * 同意ボタンがクリックされたときのイベントリスナー
             * ルールと同意セクションを非表示にし、セキュリティ質問エリアを表示します。
             */
            agreeButton.addEventListener('click', function() {
                // ボタンの二重クリックを防ぐため、クリック後すぐにボタンを無効化
                agreeButton.disabled = true;
                agreeButton.textContent = '次へ...'; // ボタンのテキストを更新

                // ルールと同意セクションを非表示にする
                rulesAndAgreementSection.classList.add('hidden');

                // セキュリティ質問エリアを表示する
                securityQuestionArea.classList.remove('hidden');
                question1Div.classList.remove('hidden'); // 質問1を表示
                question2Div.classList.add('hidden');    // 質問2は非表示
                question3Div.classList.add('hidden');    // 質問3は非表示

                adminNameInput.value = ''; // 入力フィールドをクリア
                securityMessage.classList.add('hidden'); // エラーメッセージを非表示にする
                adminNameInput.focus(); // 入力フィールドにフォーカスを当てる
                currentSecurityStep = 1; // ステップを1にリセット
            });

            /**
             * 回答送信ボタンのイベントリスナー
             * 現在のセキュリティ質問のステップに応じて回答を検証し、次のステップに進むかDiscordリンクに遷移します。
             */
            submitAnswerButton.addEventListener('click', function() {
                securityMessage.classList.add('hidden'); // エラーメッセージをリセット

                if (currentSecurityStep === 1) {
                    // 質問1の回答を検証: このサーバーの管理人は誰ですか？
                    const userAnswer = adminNameInput.value.trim();
                    const correctAnswer = 'djug';

                    if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
                        // 質問1が正解の場合、質問2を表示
                        question1Div.classList.add('hidden');
                        question2Div.classList.remove('hidden');
                        serverNameInput.value = ''; // 質問2の入力フィールドをクリア
                        serverNameInput.focus(); // 質問2の入力フィールドにフォーカス
                        currentSecurityStep = 2; // ステップを2に進める
                    } else {
                        // 質問1が不正解の場合
                        securityMessage.classList.remove('hidden');
                        securityMessage.textContent = '回答が正しくありません。もう一度お試しください。';
                        adminNameInput.value = ''; // 入力フィールドをクリア
                        adminNameInput.focus(); // 入力フィールドにフォーカス
                    }
                } else if (currentSecurityStep === 2) {
                    // 質問2の回答を検証: サーバー名は何ですか？
                    const userAnswer = serverNameInput.value.trim();
                    const correctAnswer = 'djugの雑談部'; // サーバー名を「djugの雑談部」に更新

                    if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
                        // 質問2が正解の場合、質問3を表示
                        question2Div.classList.add('hidden');
                        question3Div.classList.remove('hidden');
                        serviceNameInput.value = ''; // 質問3の入力フィールドをクリア
                        serviceNameInput.focus(); // 質問3の入力フィールドにフォーカス
                        currentSecurityStep = 3; // ステップを3に進める
                    } else {
                        // 質問2が不正解の場合
                        securityMessage.classList.remove('hidden');
                        securityMessage.textContent = '回答が正しくありません。もう一度お試しください。';
                        serverNameInput.value = ''; // 入力フィールドをクリア
                        serverNameInput.focus(); // 入力フィールドにフォーカス
                    }
                } else if (currentSecurityStep === 3) {
                    // 質問3の回答を検証: 利用しているサービス名は何ですか？
                    const userAnswer = serviceNameInput.value.trim();
                    const correctAnswer = 'discord'; // サービス名

                    if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
                        // 質問3が正解の場合、Discordへ遷移
                        securityMessage.classList.add('hidden');
                        securityQuestionArea.innerHTML = '<p class="text-green-600 font-semibold text-center">回答が確認されました。Discordへ移動します...</p>'; // 成功メッセージを表示

                        // 簡易的な遅延を設ける（例: 500ミリ秒）
                        setTimeout(() => {
                            // Discord招待リンクに遷移
                            window.location.href = 'https://discord.gg/FfT8trpRWZ';
                        }, 500); // 500ミリ秒後にリダイレクトを実行
                    } else {
                        // 質問3が不正解の場合
                        securityMessage.classList.remove('hidden');
                        securityMessage.textContent = '回答が正しくありません。もう一度お試しください。';
                        serviceNameInput.value = ''; // 入力フィールドをクリア
                        serviceNameInput.focus(); // 入力フィールドにフォーカス
                    }
                }
            });
        });
    </script>
</body>
</html>
